if(typeof(worky)=="undefined"){var worky={}}if(typeof(worky.base_url)=="undefined"){worky.base_url=null}if(typeof(worky.use_minified_scripts)=="undefined"){worky.use_minified_scripts=true}worky.translate=function(a){if(window.translation_table==undefined||window.translation_table[a]==undefined){return a}else{return window.translation_table[a]}};worky.urlify=function(a){a=a.toLowerCase().replace(/[^-\w\s]/g,"").replace(/^\s+|\s+$/g,"").replace(/[-\s]+/g,"-");return a};worky.createElement=function(a){if(document.createElementNS){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}else{return document.createElement(a)}};worky.clone=function(c){if(c==null){return c}if(typeof(c)!="object"){return c}var b=c.constructor();for(var a in c){b[a]=worky.clone(c[a])}return b};worky.flatten=function(a,b){if(typeof b=="undefined"){b=[]}if(typeof a!="object"){b.push(a)}else{for(k in a){worky.flatten(a[k],b)}}return b};worky.shadeElement=function(b,c){if(b.size()>1){b.each(function(e){worky.shadeElement($(e))});return false}if(b.data("worky_shade")){return false}if(!c){c=worky.translate("Loading....")}var d=b.position();var a=$(worky.createElement("div")).text(c);$(worky.createElement("img")).attr("alt",c).attr("title",c).attr("src",worky.base_url+"images/spinner.gif").prependTo(a);a.addClass("shade").css("position","fixed");b.offsetParent().append(a);b.data("worky_shade",a);return a};worky.unshadeElement=function(b){if(b.size()>1){b.each(function(c){worky.unshadeElement($(c))});return}var a=b.data("worky_shade",a);b.removeData("worky_shade");if(a){a.remove()}};worky.loadHtmlToElement=function(b,a){b.html(a);worky.forms.installAll(b)};worky.loadToElement=function(d,c,f,e){var b=worky.shadeElement(d);var a={};a.complete=function(){if(b){worky.unshadeElement(d)}};a.success=function(g){worky.loadHtmlToElement(d,g.data);if(f){f(true,g)}};a.error=function(g){if(f){f(false,g)}};a.dataType="json";a.url=c;a.data=e;jQuery.ajax(a)};worky._fadeFlash=function(){var a=$(this);a.fadeOut("slow",function(){a.remove()})};worky.flashAjaxHandler=function(event,request,settings){if(request&&request.getResponseHeader("Content-type")=="application/json"){var envelope=null;try{envelope=eval("("+request.responseText+")")}catch(e){return}if(envelope.flashes&&envelope.flashes.length>0){var elem=$(this);elem.empty();var i=0;for(i=0;i<envelope.flashes.length;i++){var msg=envelope.flashes[i];worky.flashAddMessage(elem,msg)}}}};worky.redirectIfNeeded=function(event,request){if(request&&request.getResponseHeader("Content-type")=="application/json"){var envelope=null;try{envelope=eval("("+request.responseText+")")}catch(e){return}if(envelope.data&&envelope.data._jsRedirect){window.location=envelope.data.url}}};worky.flashAddMessage=function(b,a){var c=$(worky.createElement("div"));c.text(a.message);c.addClass("flashesInner");c.addClass(a.severity);b.append(c);c.bind("click",worky._fadeFlash)};worky.errorAjaxHandler=function(event,request,settings){if(request&&request.getResponseHeader("Content-type")=="application/json"){var envelope=null;try{envelope=eval("("+request.responseText+")")}catch(e){return}if(envelope.data&&envelope.data._jsRedirect){window.location=envelope.data.url;return}}alert(worky.translate("An error occurred while processing your request"))};worky.asyncForm=function(a,b){a.bind("submit",function(){var c=worky._asyncFormMakeFrame(b);a.attr("target",c.attr("name"))})};worky._asyncFormId=0;worky._asyncFormMakeFrame=function(f){worky._asyncFormId+=1;var d="asyncIFrame"+worky._asyncFormId;var a=null;var c=function(){if(f&&a.contents().text().length>0){f(a)}return true};try{a=document.createElement('<iframe src="about:blank" id="'+d+'" name="'+d+'"></iframe>');a=$(a)}catch(b){a=$(worky.createElement("iframe"));a.attr("id",d);a.attr("name",d);a.attr("src","about:blank")}a.css("display","none");$("body").append(a);if(jQuery.browser.msie){a.get(0).attachEvent("onload",c)}else{a.bind("load",c)}return a};worky.decodeJSONTextResponse=function(frame){if(frame.tagName=="IFRAME"){var json=frame.contents().find("#json").text()}else{var json=$(frame).text()}if(json){return eval("("+json+")")}else{return null}};worky.sendPost=function(c){var d=$(worky.createElement("form")).appendTo($("body")).append(a).attr("action",c).attr("method","post");var b=$(worky.createElement("input")).attr("name","_csrf").attr("type","hidden").val(worky.csrf_token);var a=$(worky.createElement("DIV")).append(b);d.append(a);d.submit()};worky.turnLinkToPosting=function(b,a){b.bind("click",function(c){c.stopPropagation();c.preventDefault();var d=$(c.target);if(!d.is("a")){d=d.parents("a")}if(!a||confirm(a)){worky.sendPost(d.attr("href"))}return false})};worky.isTouchDevice=function(){var a=document.createElement("div");a.setAttribute("ongesturestart","return;");if(typeof a.ongesturestart=="function"){return true}else{return false}};worky.stripTags=function(a,c){c=(((c||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var b=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,d=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return a.replace(d,"").replace(b,function(f,e){return c.indexOf("<"+e.toLowerCase()+">")>-1?f:""})};worky.preventDoubleClick=$(document).ready(function(){$(document).bind("ajaxError",worky.errorAjaxHandler);$("#flashes").bind("ajaxComplete",worky.flashAjaxHandler);$(".datepicker-js").datepicker({showOn:"button",buttonImage:"/images-v2/icons/icon-16-calendar.png",buttonImageOnly:true,dateFormat:"dd M yy"});var a=function(){$(document).unbind("ajaxError");$(document).unbind("ajaxComplete")};$(window).bind("beforeunload",a);$(window).bind("unload",a);$("form").submit(function(){$("input[type=submit]",this).attr("disabled","disabled")})});worky.Semaphore=function(b,c,a){this._count=b>0?b:0;this._callback=c;if(!a){a=[]}this._args=a;if(this._count==0){this._fireCallback()}};worky.Semaphore.prototype._fireCallback=function(){this._callback.apply(null,this._args)};worky.Semaphore.prototype.release=function(){if(--this._count==0){this._fireCallback()}else{if(this._count<0){throw"Release called on unlocked semaphore"}}};worky.notifications={};worky.notifications._callbacks={};worky.notifications.registerEvent=function(a,c){if(worky.notifications._callbacks[a]==null){worky.notifications._callbacks[a]=[]}for(var b=0;b<worky.notifications._callbacks[a].length;b++){if(worky.notifications._callbacks[a][b]==c){return}}worky.notifications._callbacks[a].push(c)};worky.notifications.trigger=function(b,e){var d=worky.notifications._callbacks[b];if(!d){return}for(var c=0;c<d.length;c++){var a=d[c];a(b,e)}return};worky.notifications.dispatchEvents=function(event,request,settings){if(request&&request.getResponseHeader("Content-type")=="application/json"){var envelope=null;try{envelope=eval("("+request.responseText+")")}catch(e){return}if(!envelope.notifications){return}var values=envelope.notifications;if(!values){return}for(k in values){worky.notifications.trigger(k,values[k])}}};$(document).bind("ajaxComplete",worky.notifications.dispatchEvents);worky.notifications.registerEvent("currentUserUpdated",function(a,b){if(b.nationalityCode&&b.nationalityName){worky.candidate.reloadFlag(b.nationalityCode,b.nationalityName)}if(b.fullName){worky.candidate.reloadFullName(b.fullName)}if(b.displayName){worky.candidate.reloadDisplayName(b.displayName)}if(b.degreeName){worky.candidate.reloadEducationDegree(b.degreeName)}if(b.age){worky.candidate.reloadAge(b.age)}if(b.gender){worky.candidate.reloadGender(b.gender)}if(b.skills){worky.candidate.reloadSkills(b.skills)}});worky.cookie={};worky.cookie.getCookie=function(b,a){var c=document.cookie.match("(^|;) ?"+b+"=([^;]*)(;|$)");if(c){return(unescape(c[2]))}else{return a}};worky.cookie.setCookie=function(b,g,i,f,h,j,e,a){var d=b+"="+escape(g);if(i){var c=new Date(i,f,h);d+="; expires="+c.toGMTString()}if(j){d+="; path="+escape(j)}if(e){d+="; domain="+escape(e)}if(a){d+="; secure"}document.cookie=d};worky.cookie.deleteCookie=function(a){var b=new Date();b.setTime(b.getTime()-1);document.cookie=a+="=; expires="+b.toGMTString()};worky.widgets={};worky.widgets.ERRORS_PER_ELEMENT=1;worky.widgets.ERRORS_AGGREGATED=2;worky.widgets.ERRORS_DONT_DISPLAY=3;worky.widgets.hint=function(b,a){var c=b.data("worky_hint");if(!a){if(c){c.remove();b.removeData("worky_hint")}}else{if(!c){c=$(worky.createElement("div")).addClass("widget-hint").insertAfter(b);b.data("worky_hint",c)}c.html(a)}};worky.widgets.fillSelect=function(a,d){for(var c=0;c<d.length;c++){var b=d[c];var e=$(worky.createElement("option"));e.attr("value",b[0]);e.text(b[1]);a.append(e)}};worky.widgets.setErrors=function(b,e,d,c){if(!b&&!e){return}if(typeof c=="undefined"){c=worky.widgets.ERRORS_PER_ELEMENT}if(c==worky.widgets.ERRORS_DONT_DISPLAY){e=null}else{if(!e&&c==worky.widgets.ERRORS_PER_ELEMENT){e=worky.widgets.getErrorContainer(b)}else{if(!e&&c==worky.widgets.ERRORS_AGGREGATED){e=worky.widgets.getErrorContainer(b,true)}}}if(typeof msgs=="object"&&msgs.constructor!=Array){d=worky.flatten(d)}if(!d||d.length==0){if(b){b.removeClass("widget-with-errors")}if(e&&c==worky.widgets.ERRORS_PER_ELEMENT){if(e.data("error-container-synthetic")){b.data("error-container",null);e.remove()}else{e.empty();e.append($(worky.createElement("li")));e.hide()}}}else{if(b){b.addClass("widget-with-errors")}if(e){if(c==worky.widgets.ERRORS_PER_ELEMENT){e.empty()}if(typeof d=="string"){d=[d]}if(d.constructor!=Array){d=worky.flatten(d)}for(var a=0;a<d.length;a++){$(worky.createElement("li")).text(d[a]).appendTo(e)}e.show()}}};worky.widgets.setManyErrors=function(i,g,b,a,c){if(!c){c=""}if(!a){a=null}for(var h in g){var e=g[h];if(!e){continue}var d=h;if(c){d=c+"["+h+"]"}if(typeof e=="string"||e.constructor==Array){var f=i.find("input[name='"+d+"']").add("textarea[name='"+d+"']").add("select[name='"+d+"']");if(f.size()==0){continue}else{if(f.size()>1){f=f.eq(1)}}worky.widgets.setErrors(f,a,e,b)}else{worky.widgets.setManyErrors(i,e,b,a,d)}}};worky.widgets.clearErrors=function(a){worky.widgets.unsetErrorContainer(a);a.removeClass("widget-with-errors")};worky.widgets.clearManyErrors=function(a){a.find(".widget-with-errors").each(function(){worky.widgets.unsetErrorContainer(a)}).removeClass("widget-with-errors")};worky.widgets.getErrorContainer=function(c,d){var b=c.data("error-container");if(!b&&!d){b=$(worky.createElement("ul")).hide().addClass("errors").append($(worky.createElement("li")));var a=c;if(c.parents("label").size()>0){a=c.parents("label")}if(c.parents("p").size()>0){a=c.parents("label")}a.after(b);c.data("error-container",b);b.data("error-container-synthetic",true)}return b};worky.widgets.setErrorContainer=function(b,a){worky.widgets.unsetErrorContainer(b);b.data("error-container",a)};worky.widgets.unsetErrorContainer=function(a){var b=a.data("error-container");if(b){if(b.data("error-container-synthetic")){b.remove()}a.removeData("error-container").removeClass("widget-with-errors")}};worky.widgets.unsetManyErrorContainers=function(a){a.find(":input").each(function(){worky.widgets.unsetErrorContainer($(this))})};worky.widgets.toggableDivHandler=function(){var a=$(this).parents(".toggable-div");if(a.hasClass("toggable-div-short")){a.removeClass("toggable-div-short").addClass("toggable-div-long")}else{a.addClass("toggable-div-short").removeClass("toggable-div-long")}};worky.widgets.toggableDivShow=function(){var a=$(this).parents(".toggable-div");a.removeClass("toggable-div-short").addClass("toggable-div-long")};worky.widgets.toggableDivHide=function(){var a=$(this).parents(".toggable-div");a.addClass("toggable-div-short").removeClass("toggable-div-long")};worky.widgets.NationalityWidget=function(c){if(c.length==0){return}var f=c.find("ul");var g=$("img#currentFlag");var b=(f.find("li").size()>0);var i=function(){if(!b){worky.shadeElement(c);jQuery.ajax({url:worky.base_url+"data/nationality-widget-data",type:"GET",dataType:"json",success:function(j){f.html(j.data);b=true;worky.unshadeElement(c)}})}};var d=function(){c.show();i()};var e=function(){c.hide()};var a=c.find("input[name=selectedNationality]");var h=$("a#wrongNationality");h.toggle(d,e);c.bind("click",function(n){n.stopPropagation();n.preventDefault();var m=$(n.target);if(m.get(0).tagName.toUpperCase()!="LI"){m=m.parents("li")}if(m.length>0&&g.length>0){var o=jQuery.trim(m.find(".nationality-name").text());var j=jQuery.trim(m.find(".nationality-code").text());if(j==""){return false}a.val(j);$("span#guessedNationality").text(o);var l="unknown";if(j){l=j.toLowerCase()}g.attr("src",worky.base_url+"images/flags/"+l+".gif");g.attr("alt",o);h.click()}return false})};worky.widgets.Autocompleter=function(b,d,c){this.input=b;this.options={};var a;for(a in worky.widgets.Autocompleter.defaults){this.options[a]=worky.widgets.Autocompleter.defaults[a]}if(c){for(a in c){this.options[a]=c[a]}}this.blockSubmit=false;this.select=null;this.loadTimeout=null;this.hideTimeout=null;this.data=d;this.cache=null;this.dataSourceIndex=0;this.currentlyLoading=false;if(this.input){this.init()}};worky.widgets.Autocompleter.defaults={actOnTab:false,loadTimeout:500,minChars:1,formatItem:null,additionalItems:null};worky.widgets.Autocompleter.prototype.init=function(){var a=this;this.select=new worky.widgets.AutocompleterSelect(this);this.input.bind(($.browser.opera?"keypress":"keydown")+".autocomplete",function(b){return a.keyEvent(b)});if($.browser.opera){$(this.input.form).bind("submit.autocomplete",function(){if(this.blockSubmit){this.blockSubmit=false;return false}else{return true}})}this.input.bind("focus.autocomplete",function(b){a.showCompletion();return false});this.input.bind("blur.autocomplete",function(b){if(!a.hideTimeout){a.hideTimeout=setTimeout(function(){a.hideTimeout=null;a.hideCompletion()},100)}});this.input.attr("autocomplete","off")};worky.widgets.Autocompleter.prototype.destroy=function(){if(this.input){this.input.unbind(($.browser.opera?"keypress":"keydown")+".autocomplete");this.input.removeClass("autocomplete-loading");this.input.unbind("submit.autocomplete");this.input.unbind("focus.autocomplete");this.input.unbind("blur.autocomplete");this.input=null}if(this.select){this.select.destroy();this.select=null}if(this.loadTimeout){clearTimeout(this.loadTimeout);this.loadTimeout=null}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}};worky.widgets.Autocompleter.prototype.setOptions=function(b){for(var a in b){this.options[a]=b[a]}};worky.widgets.Autocompleter.prototype.setData=function(a){this.cache=null;this.select.update([]);this.data=a;this.dataSourceIndex++;this.currentlyLoading=false;if(this.loadTimeout){clearTimeout(this.loadTimeout);this.loadTimeout=null}};worky.widgets.Autocompleter.prototype.keyEvent=function(f){var b={UP:38,DOWN:40,RETURN:13,ESC:27,TAB:9};var e=this;switch(f.keyCode){case b.UP:f.preventDefault();this.showCompletion(true);this.select.prev();break;case b.DOWN:f.preventDefault();this.showCompletion(true);this.select.next();break;case b.RETURN:case b.TAB:if(f.keyCode==b.TAB&&!this.options.actOnTab){return true}f.preventDefault();this.blockSubmit=true;var d=this.select.currentKeyAndValue();var a=false;if(d){var h=d[1].toLowerCase();var c=this.input.val().toLowerCase();if(this.options.multiple){c=jQuery.trim(c.split(",").pop())}if(h.substring(0,c.length)==c){this.selected(d[0],d[1]);a=true}}if(!a){var g=this.input.val();if(this.options.multiple){g=jQuery.trim(g.split(",").pop())}this.selected(null,g)}this.hideCompletion();return false;case b.ESC:this.hideCompletion();break;default:if(!this.loadTimeout){this.loadTimeout=setTimeout(function(){e.loadData();e.loadTimeout=false},e.options.loadTimeout)}this.showCompletion();break}};worky.widgets.Autocompleter.prototype.showCompletion=function(b){var a=this.input.val();if(this.options.multiple){a=a.split(",").pop()}a=jQuery.trim(a);if(!this.cache&&(b||a.length>=this.options.minChars)){this.loadData()}this.select.show()};worky.widgets.Autocompleter.prototype.hideCompletion=function(){if(this.select){this.select.hide()}};worky.widgets.Autocompleter.prototype.loadData=function(){if(this.currentlyLoading){if(this.cache){this.select.update(this.cache)}return}this.currentlyLoading=true;if(typeof(this.data)=="string"){this.input.addClass("autocomplete-loading");var a=this.dataSourceIndex;var b=this;var c=b.input.val();if(b.options.multiple){c=c.split(",");c=jQuery.trim(c.pop())}$.ajax({dataType:"json",url:this.data,data:{q:c},success:function(e){if(a==b.dataSourceIndex){b.cache=e.data;if(b.options.additionalItems){for(var d=0;d<b.options.additionalItems.length;d++){b.cache.push(b.options.additionalItems[d])}}if(b.select){b.select.update(b.cache)}}},complete:function(){if(b.input){b.input.removeClass("autocomplete-loading")}b.currentlyLoading=false}})}else{this.cache=this.data;this.currentlyLoading=false;this.select.update(this.cache)}};worky.widgets.Autocompleter.prototype.selected=function(c,d){if(this.options.multiple){var a=this.input.val().split(",");var e="";var b;a.pop();a.push(d);for(b=0;b<a.length;b++){e+=jQuery.trim(a[b])+", "}this.input.val(e)}else{this.input.val(d)}if(this.options.selected){this.options.selected(c,d)}if(this.input){this.input.trigger("change")}};worky.widgets.AutocompleterSelect=function(a){this.autocompleter=a;this.select=null;this.list=null;this.data=null;this.visible=false;this.IEHackIframe=null;this.useIEHackIframe=($.browser.msie&&/6.0/.test(navigator.userAgent));if(a){this.init()}};worky.widgets.AutocompleterSelect.prototype.init=function(){};worky.widgets.AutocompleterSelect.prototype.destroy=function(){this.destroyElements();this.data=null;this.autocompleter=null};worky.widgets.AutocompleterSelect.prototype.createElements=function(){if(this.select){return}else{if(this.useIEHackIframe){this.IEHackIframe=$(worky.createElement("iframe")).appendTo(document.body)}this.select=$(worky.createElement("div")).hide().addClass("autocomplete-results").css("position","absolute").appendTo(document.body);this.list=$(worky.createElement("ul")).appendTo(this.select);var a=this;this.list.bind("mouseover",function(b){var c=a.eventTarget(b);if(c&&c.nodeName&&c.nodeName.toUpperCase()=="LI"){a.currentItem().removeClass("autocomplete-selected");$(c).addClass("autocomplete-selected")}});this.list.bind("mousedown",function(b){var c=a.currentKeyAndValue();if(c){a.autocompleter.selected(c[0],c[1])}});this.fillList()}};worky.widgets.AutocompleterSelect.prototype.destroyElements=function(){if(this.list){this.list.remove();this.list=null}if(this.select){this.select.remove();this.select=null}if(this.IEHackIframe){this.IEHackIframe.remove();this.IEHackIframe=null}};worky.widgets.AutocompleterSelect.prototype.show=function(){this.visible=true;this.updateVisibility()};worky.widgets.AutocompleterSelect.prototype.hide=function(){this.visible=false;this.updateVisibility()};worky.widgets.AutocompleterSelect.prototype.updateVisibility=function(){if(this.visible&&this.data&&this.data.length>0){this.createElements();var a=this.autocompleter.input.offset();this.select.css("left",(a.left-1)+"px");this.select.css("top",(a.top+this.autocompleter.input.get(0).offsetHeight)+"px");this.select.css("width",this.autocompleter.input.get(0).offsetWidth+"px");this.select.show();if(this.IEHackIframe){this.IEHackIframe.css("position","absolute");this.IEHackIframe.css("left",a.left+"px");this.IEHackIframe.css("top",(a.top+this.autocompleter.input.get(0).offsetHeight)+"px");this.IEHackIframe.css("width",this.autocompleter.input.get(0).offsetWidth+"px");this.IEHackIframe.css("height",this.select.get(0).offsetHeight+"px")}this.select.css("left",a.left+"px")}else{this.destroyElements()}};worky.widgets.AutocompleterSelect.prototype.fillList=function(){if(!this.list){return}this.list.empty();for(var b=0;b<this.data.length;b++){var c=this.data[b];var a=$(worky.createElement("li")).text(c[1]).data("autocomplete_key",c[0]).data("autocomplete_value",c[1]);if(b%2==1){a.addClass("autocomplete-odd")}if(b==0){a.addClass("autocomplete-selected")}a.appendTo(this.list)}};worky.widgets.AutocompleterSelect.prototype.update=function(d){this.data=[];var e=this.autocompleter.input.val().toLowerCase();if(this.autocompleter.options.multiple){e=e.split(",");e=jQuery.trim(e.pop())}for(var b in d){var c=d[b];var f=c[1];var a=c[0];if(this.autocompleter.options.formatItem){f=this.autocompleter.options.formatItem(a,f)}if(f.toLowerCase().substring(0,e.length)!=e){continue}this.data.push([a,f])}this.fillList();this.updateVisibility()};worky.widgets.AutocompleterSelect.prototype.eventTarget=function(b){if(!this.list){return null}var a=this.list.get(0);var c=b.target;if(!c){return null}while(c&&c.parentNode!=a){c=c.parentNode}return c};worky.widgets.AutocompleterSelect.prototype.currentItem=function(){if(!this.list){return null}return this.list.find(".autocomplete-selected")};worky.widgets.AutocompleterSelect.prototype.currentKeyAndValue=function(){if(!this.list){return null}var a=this.currentItem();if(a.size()==0){return null}return[a.data("autocomplete_key"),a.data("autocomplete_value")]};worky.widgets.AutocompleterSelect.prototype.prev=function(){this.moveBy(-1)};worky.widgets.AutocompleterSelect.prototype.next=function(){this.moveBy(1)};worky.widgets.AutocompleterSelect.prototype.moveBy=function(d){if(!this.list){return}var c=this.list.find(".autocomplete-selected");var b=this.list.find("li");if(b.length==0){return}if(c.length==0){next=b.eq(0)}else{var a=b.index(c.get(0));a=a+d;if(a<0){a+=b.size()}if(a>=b.size()){a-=b.size()}next=b.eq(a)}c.removeClass("autocomplete-selected");next.addClass("autocomplete-selected")};worky.widgets.InPlaceEditor=function(d,c,b,a){this.element=d;this.url=c;this.fieldName=b;this.state=false;this.preservedText=null;this.inputElement=null;this.errorContainer=null;if(!a){this.options={}}else{this.options=a}if(typeof(this.options.defaultText)=="undefined"){this.options.defaultText=worky.translate("Click here to add text")}if(d){this.init()}};worky.widgets.InPlaceEditor.prototype.init=function(){this.element.data("in-place-editor",this);this.element.addClass("in-place-element").addClass("inactive");this.element.bind("click",this.activatorEventHandler);this.element.attr("title",worky.translate("Click to edit text"));if(jQuery.trim(this.element.text())==""){this.element.text(this.options.defaultText)}};worky.widgets.InPlaceEditor.prototype.deactivate=function(b,a){if(!this.state){return}this.state=false;if(this.input){this.input.remove();this.input=null}if(this.errorContainer){this.errorContainer.remove();this.errorContainer=null}this.element.empty();if(a){this.element.append(b)}else{this.element.text(b)}if(jQuery.trim(this.element.text())==""){this.element.text(this.options.defaultText)}if(this.autocompleter){this.autocompleter.destroy();this.autocompleter=null}};worky.widgets.InPlaceEditor.prototype.activatorEventHandler=function(a){$(this).data("in-place-editor").activate()};worky.widgets.InPlaceEditor.prototype.isActive=function(){return this.state};worky.widgets.InPlaceEditor.prototype.activate=function(){if(this.state){return true}this.preservedText=this.element.text();var a=this;this.state=true;worky.shadeElement(a.element);this.createInputField(this.preservedText,function(b){worky.unshadeElement(a.element);if(!b){a.deactivate(a.preservedText);return false}a.input=b;var c=$(worky.createElement("button"));c.text(worky.translate("OK"));c.addClass("btnInplaceOk");c.bind("click",function(){a.send(b);return false});var d=$(worky.createElement("button"));d.text(worky.translate("Cancel"));d.addClass("btnInplaceCancel");d.bind("click",function(){a.deactivate(a.preservedText);return false});a.errorContainer=$(worky.createElement("ul")).hide().addClass("errors").append($(worky.createElement("li")));a.element.empty();a.element.append(a.input);if(a.options.beforeButtons){a.element.append(a.options.beforeButtons)}a.element.append(a.errorContainer);a.element.append(c);a.element.append(d);b.focus();return false});return true};worky.widgets.InPlaceEditor.prototype.send=function(b){var c={};var a=this;c.url=this.url;c.type="POST";c.dataType="json";c.data={};c.data[b.attr("name")]=b.val();c.success=function(d){worky.unshadeElement(a.element);a.receive(d.data)};c.error=function(){worky.unshadeElement(a.element)};worky.shadeElement(a.element);jQuery.ajax(c)};worky.widgets.InPlaceEditor.prototype.receive=function(a){if(a.ok){this.receiveOK(a)}else{this.receiveError(a)}};worky.widgets.InPlaceEditor.prototype.receiveOK=function(a){this.deactivate(a.values[this.fieldName])};worky.widgets.InPlaceEditor.prototype.receiveError=function(a){worky.widgets.setErrors(this.input,this.errorContainer,a.errors[this.fieldName])};worky.widgets.InPlaceEditor.prototype.createInputField=function(d,a){var c=null;var b=this;c=$(worky.createElement("input"));if(d==this.options.defaultText){c.val("")}else{c.val(d)}if(this.options.size){c.attr("size",this.options.size)}if(b.options.autocomplete){this.autocompleter=new worky.widgets.Autocompleter(c,b.options.autocomplete)}c.bind("keydown",function(e){if(e.keyCode==13||e.keyCode==10){b.send(c)}});c.attr("name",this.fieldName);a(c)};worky.widgets.InPlaceSelectEditor=function(d,c,b,a){worky.widgets.InPlaceEditor.call(this,d,c,b,a);this.current_options=null};worky.widgets.InPlaceSelectEditor.prototype=new worky.widgets.InPlaceEditor();worky.widgets.InPlaceSelectEditor.prototype.constructor=worky.widgets.InPlaceSelectEditor;worky.widgets.InPlaceSelectEditor.prototype.createInputField=function(e,a){var c=null;c=$(worky.createElement("select"));c.attr("name",this.fieldName);if(e==this.options.defaultText){e=""}var b=this;var d=function(h){if(h.data){h=h.data}b.current_options=h;for(var g=0;g<h.length;g++){var f=h[g];var j=$(worky.createElement("option"));j.attr("value",f[0]);j.text(f[1]);if(e==f[1]){j.attr("selected",true)}c.append(j)}a(c)};if(this.options.values_url){jQuery.ajax({url:this.options.values_url,success:d,dataType:"json"})}else{d(b.options.values)}};worky.widgets.InPlaceSelectEditor.prototype.receiveOK=function(c){for(var b=0;b<this.current_options.length;b++){var a=this.current_options[b];if(a[0]==c.values[this.fieldName]){this.deactivate(a[1]);return}}this.deactivate(c.values[this.fieldName])};worky.widgets.InPlaceTextAreaEditor=function(d,c,b,a){worky.widgets.InPlaceEditor.call(this,d,c,b,a)};worky.widgets.InPlaceTextAreaEditor.prototype=new worky.widgets.InPlaceEditor();worky.widgets.InPlaceTextAreaEditor.prototype.constructor=worky.widgets.InPlaceTextAreaEditor;worky.widgets.InPlaceTextAreaEditor.prototype.createInputField=function(c,a){var b=null;b=$(worky.createElement("textarea"));if(c==this.options.defaultText){b.val("")}else{b.val(jQuery.trim(c))}b.attr("name",this.fieldName);if(this.options.cols){b.attr("cols",this.options.cols)}else{b.attr("cols",40)}if(this.options.rows){b.attr("rows",this.options.rows)}else{b.attr("rows",40)}a(b)};worky.widgets.InPlaceTextAreaEditor.prototype.receiveOK=function(d){var b=jQuery.trim(d.values[this.fieldName]);if(b.length==0){this.deactivate("")}else{b=b.split("\n");var c=$(worky.createElement("span"));for(var a=0;a<b.length;a++){c.append(document.createTextNode(b[a]));if(a+1!=b.length){c.append(document.createTextNode("\n"))}}this.deactivate(c.html(),true)}};worky.widgets.InPlacePasswordChange=function(e,d,c,a,b){if(!b){b={}}if(!b.defaultText){b.defaultText="******"}this.confirmName=a;worky.widgets.InPlaceEditor.call(this,e,d,c,b)};worky.widgets.InPlacePasswordChange.prototype=new worky.widgets.InPlaceEditor();worky.widgets.InPlacePasswordChange.constructor=worky.widgets.InPlacePasswordChange;worky.widgets.InPlacePasswordChange.prototype.createInputField=function(g,a){var c=null;var b=this;var f=$(worky.createElement("label"));f.attr("for",this.fieldName).addClass("password-label");f.text("Password");c=$(worky.createElement("input"));c.attr("type","password");c.attr("name",this.fieldName);var d=$(worky.createElement("label"));d.attr("for",this.confirmName);d.text("Confirm Password").addClass("password-label");var e=null;e=$(worky.createElement("input"));e.attr("type","password");e.attr("name",this.confirmName);b.errorContainer=$(worky.createElement("ul")).hide().addClass("errors").append($(worky.createElement("li")));var h=null;h=$(worky.createElement("div"));h.append(f);h.append(c);h.append(d);h.append(e);h.append(b.errorContainer);a(h)};worky.widgets.InPlacePasswordChange.prototype.recieveOK=function(a){this.deactivate(this.defaultText)};worky.widgets.InPlacePasswordChange.prototype.send=function(b){var c={};var a=this;c.url=this.url;c.type="POST";c.dataType="json";c.data={};b.find("input").each(function(d,f){var g=$(f);c.data[g.attr("name")]=g.val()});c.success=function(d){worky.unshadeElement(a.element);a.receive(d.data)};c.errors=function(){worky.unshadeElement(a.element)};worky.shadeElement(a.element);jQuery.ajax(c)};worky.widgets.Slider=function(c,a,b){this.element=c;this.sliderElement=null;this.labelElement=null;this.initialPosition=undefined;this.jqueryoptions=a||{};this.options=b||{};if(c){this.init()}};worky.widgets.Slider.prototype.init=function(){var a=this;if(typeof this.options.initialPosition!="undefined"){this.initialPosition=this.options.initialPosition}if(typeof this.initialPosition=="undefined"){this.initialPosition=this._initialPositionFromText(jQuery.trim(this.element.text()))}if(isNaN(this.initialPosition)||this.initialPosition<this.jqueryoptions.min){this.initialPosition=this.jqueryoptions.min}if(isNaN(this.initialPosition)||typeof(this.initialPosition)=="undefined"){this.initialPosition=0}this.jqueryoptions.startValue=this._positionScaleReverse(this.initialPosition);this.jqueryoptions.value=this._positionScaleReverse(this.initialPosition);this.jqueryoptions.change=function(c,b){a._setLabel(a._positionScale(b.value));a._send(a._positionScale(b.value));if(a.options.change){a.options.change(c,b)}if(a.options.slideOrChange){a.options.slideOrChange(c,b)}};this.jqueryoptions.slide=function(c,b){a._setLabel(a._positionScale(b.value));if(a.options.slide){a.options.slide(c,b)}if(a.options.slideOrChange){a.options.slideOrChange(c,b)}};this.element.empty().addClass("widget-slider-container");this.sliderElement=$(worky.createElement("div")).addClass("widget-slider").appendTo(this.element).slider(this.jqueryoptions);this.sliderElement.find(".ui-slider-handle").css("position","absolute");if(this.options.addLabel){this.labelElement=$(worky.createElement("span")).addClass("widget-slider-label").appendTo(this.element);this._setLabel(this.position())}if(this.options.init){this.options.init(this,this.position())}};worky.widgets.Slider.prototype.value=function(b){var a;if(b==undefined){a=this.position()}else{a=this._positionScale(b)}return this._positionToValue(a)};worky.widgets.Slider.prototype.label=function(b){var a;if(b==undefined){a=this.position()}else{a=this._positionScale(b)}return this._positionToLabel(a)};worky.widgets.Slider.prototype.position=function(a){if(a==undefined){a=this.sliderElement.slider("value")}return this._positionScale(a)};worky.widgets.Slider.prototype.moveHandle=function(a){this.sliderElement.slider("moveTo",this._positionScaleReverse(a),index=null)};worky.widgets.Slider.prototype._setLabel=function(a){if(this.labelElement){this.labelElement.text(this._positionToLabel(a))}};worky.widgets.Slider.prototype._send=function(a){if(!this.options.url||!this.options.name){return}var c={};if(this.options.data){c=this.options.data}c[this.options.name]=this._positionToValue(a);var b={url:this.options.url,type:"POST",dataType:"json",data:c};jQuery.ajax(b)};worky.widgets.Slider.prototype._positionToLabel=function(a){if(this.options.positionToLabelCallback){return this.options.positionToLabelCallback(a)}else{return a}};worky.widgets.Slider.prototype._positionToValue=function(a){if(this.options.positionToValueCallback){return this.options.positionToValueCallback(a)}else{return a}};worky.widgets.Slider.prototype._initialPositionFromText=function(a){if(this.options.initialPositionCallback){return this.options.initialPositionCallback(a)}else{return a}};worky.widgets.Slider.prototype._positionScale=function(a){if(this.options.positionScale){return this.options.positionScale.call(this,a)}return a};worky.widgets.Slider.prototype._positionScaleReverse=function(a){if(this.options.positionScaleReverse){return this.options.positionScaleReverse.call(this,a)}return a};worky.widgets.EnumerationSlider=function(c,d,a,b){this.enumeration=d;worky.widgets.Slider.call(this,c,a,b)};worky.widgets.EnumerationSlider.prototype=new worky.widgets.Slider();worky.widgets.EnumerationSlider.prototype.constructor=worky.widgets.EnumerationSlider;worky.widgets.EnumerationSlider.prototype.init=function(){this._loadData(function(){if(typeof this.jqueryoptions.min=="undefined"){this.jqueryoptions.min=0}if(typeof this.jqueryoptions.max=="undefined"){this.jqueryoptions.max=this.enumeration.length-1}if(typeof this.jqueryoptions.stepping=="undefined"){this.jqueryoptions.stepping=0}worky.widgets.Slider.prototype.init.call(this)})};worky.widgets.EnumerationSlider.prototype._loadData=function(a){var f=this;var h=function(l){var j;for(j in f.enumeration){if(f.enumeration[j][0]==l){return j}}return NaN};var e=function(i){return f.enumeration[i][0]};var b=function(i){try{return f.enumeration[i][1]}catch(j){return""}};if(typeof(f.options.initialPositionCallback)=="undefined"){f.options.initialPositionCallback=h}if(typeof(f.options.positionToValueCallback)=="undefined"){f.options.positionToValueCallback=e}if(typeof(f.options.positionToLabelCallback)=="undefined"){f.options.positionToLabelCallback=b}if(this.enumeration instanceof Array){a.call(f)}else{if(this.enumeration=="select://"){var d=this.element.find("select");var g=[];var c=null;d.find("option").each(function(){var i=$(this);g.push([i.attr("value"),jQuery.trim(i.text())]);if(i.attr("selected")){c=i.attr("value")}});this.enumeration=g;this.initialPosition=h(c);a.call(f)}else{if((typeof this.enumeration)=="string"){f.element.worky_shade();jQuery.getJSON(this.enumeration,function(i){f.element.worky_unshade();f.enumeration=i.data;a.call(f);if(f.options.onLoad){f.options.onLoad(f)}})}}}};worky.widgets.EnumerationSlider.PositionScale25Width=999;worky.widgets.EnumerationSlider.PositionScale25=function(a){if(a<250){return 0}var b=750/(this.enumeration.length-1);a-=250;a=1+Math.floor(a/b);if(a>=this.enumeration.length){a=this.enumeration.length-1}return a};worky.widgets.EnumerationSlider.PositionScale25Reverse=function(a){if(a==0){return 0}else{var b=750/(this.enumeration.length-1);a=250+(a-1)*b+Math.round(b/2);if(a>1000){a=1000}return a}};worky.favourites={};worky.favourites.updateLinkAfterAddedToFavourites=function(a){worky.unshadeElement(a);a.removeClass("add-to-favourites");a.addClass("remove-from-favourites");a.attr("title","Remove from favourites");text=worky.translate("Remove from favourites");a.text(text)};worky.favourites.toggleFavouriteIndicator=function(a){var b=$("#fav-indicator-job-card-"+a);if(b.length>0){if(b.hasClass("hidden")){b.removeClass("hidden");b.addClass("favourite-indicator")}else{if(b.hasClass("favourite-indicator")){b.removeClass("favourite-indicator");b.addClass("hidden")}}}};worky.favourites.updateLinkAfterRemovedFromFavourites=function(a){worky.unshadeElement(a);a.addClass("add-to-favourites");a.removeClass("remove-from-favourites");a.attr("title","Add to favourites");text=worky.translate("Add to favourites");a.text(text)};worky.rejections={};worky.rejections.updateLinkAfterRejected=function(a,b){worky.unshadeElement(a);a.removeClass("reject-"+b);a.addClass("unreject-"+b);a.text("Add to shortlist");a.attr("title","Add to shortlist")};worky.rejections.updateLinkAfterUnrejected=function(a,b){worky.unshadeElement(a);a.removeClass("unreject-"+b);a.addClass("reject-"+b);a.text("Not for me");a.attr("title","Not for me")};worky.applications={};worky.applications.formattedDate=function(){var b=new Date();var a=(b.getMonth()+1).toString();if(a.length<2){a="0"+a}return b.getDate().toString()+"/"+a+"/"+b.getFullYear()};worky.applications.updateLinkAfterApplied=function(b,a){b.find(".toggable-div-activator").removeClass("applyLeft");b.find(".formMsg-apply").text("Send another message");b.find(".formMsg-apply").attr("class","formMsg-send");b.find(".jobDetail-datestamp").text(worky.translate("You applied for this job"))};worky.approaches={};worky.approaches.updateLinkAfterApproached=function(b){var a=$("#approach-link-"+b);if(a.length>0){if(a.hasClass("approach-link")){a.removeClass("approach-link").addClass("approached-link").text(worky.translate("Approached")).after(" "+worky.applications.formattedDate())}}};worky.forms={};worky.forms.__elementsWaitingForClassLoad={};worky.forms.__getClassNameWithoutDashes=function(a){var d=a.split("-");var c="";for(var b=0;b<d.length;b++){c=c+d[b].substring(0,1).toUpperCase()+d[b].substring(1)}return c+"Form"};worky.forms.__instantiate=function(b,a){var c=worky.forms.__getClassNameWithoutDashes(a);if(typeof(worky.forms[c])!="undefined"){worky.forms.__instantiateWithoutLoading(b,a)}else{worky.forms.__loadClassAndInstantiate(b,a)}};worky.forms.__instantiateWithoutLoading=function(c,a){var d=worky.forms.__getClassNameWithoutDashes(a);var b=worky.forms[d];if(b){setTimeout(function(){new b($(c))},1)}};worky.forms.__loadClassAndInstantiate=function(b,a){if(typeof(worky.forms.__elementsWaitingForClassLoad[a])=="undefined"){worky.forms.__elementsWaitingForClassLoad[a]=[b];worky.forms.__loadClassDefinition(a)}else{worky.forms.__elementsWaitingForClassLoad[a].push(b)}};worky.forms.__classGotLoaded=function(a){if(worky.forms.__elementsWaitingForClassLoad[a]!=undefined){var d=worky.forms.__elementsWaitingForClassLoad[a];var c=null;var b=0;for(b=0;b<d.length;b++){c=d[b];worky.forms.__instantiateWithoutLoading(c,a)}delete worky.forms.__elementsWaitingForClassLoad[a]}};worky.forms.__loadClassDefinition=function(dashedClassName){var className=worky.forms.__getClassNameWithoutDashes(dashedClassName);var url=worky.base_url+"js/forms/"+dashedClassName;if(worky.use_minified_scripts){url=url+".min"}url=url+".js";$.ajax({url:url,dataType:"text",success:function(src){if(typeof worky.forms[className]=="undefined"){eval(src);worky.forms.__classGotLoaded(dashedClassName)}}})};$(document).ready(function(){worky.forms.installAll($(document))});worky.forms.installAll=function(a){a.find(".form").each(function(){worky.forms.install(this)})};worky.forms.install=function(d){if($(d).data("forms-installed")){return false}else{$(d).data("forms-installed",true)}var c=$(d).attr("class").split(" ");for(var b=0;b<c.length;b++){if(c[b].substring(0,5)=="form-"){var a=c[b].substring(5);worky.forms.__instantiate(d,a);break}}return true};worky.forms.Form=function(a){this.element=null;this.url=null;this._dialogBox=false;if(a){this.element=a;this.init()}};worky.forms.Form.prototype.init=function(){this.element.data("form",this);var a=this;setTimeout(function(){a.element.trigger("WorkyFormInitialized",[a])},0)};worky.forms.Form.prototype.__findDialogBox=function(){if(this._dialogBox===false){this._dialogBox=null;var a=this.element.parent();while(a.size()>0){if(a.hasClass("dialog")){this._dialogBox=a;break}a=a.parent()}}return this._dialogBox};worky.forms.Form.prototype.isInDialog=function(){return(this.__findDialogBox()!=null)};worky.forms.Form.prototype.dialogBox=function(){return this.__findDialogBox()};worky.forms.JobSendLinkForm=function(a){worky.forms.Form.call(this,a)};worky.forms.JobSendLinkForm.prototype=new worky.forms.Form();worky.forms.JobSendLinkForm.prototype.constructor=worky.forms.JobSendLinkForm;worky.forms.JobSendLinkForm.prototype.init=function(){worky.forms.Form.prototype.init.call(this);var b=this.element;b.bind("submit",function(j){j.preventDefault();j.stopPropagation();var h=b.find("#fromEmail")[0].value;var f=b.find("#jobId")[0].value;var g=b.find("#email")[0].value;var i=b.find("#message")[0].value;var l=function(p){var q=b.find(".errors");if(q.length>0){q.remove()}var o=$(worky.createElement("div")).addClass("flashes-ajax").prependTo(b);if(p.flashes){var m=0;for(m=0;m<p.flashes.length;m++){var e=p.flashes[m];worky.flashAddMessage(o,e)}}if(p.data.errors){var n=$(worky.createElement("ul")).addClass("errors");$.each(p.data.errors,function(r,s){if(s.length>0){n.append($(worky.createElement("li")).text(r+": "+s))}});b.append(n)}else{$.facebox.close()}};jQuery.ajax({type:"POST",url:b.attr("action"),dataType:"json",success:l,data:{fromEmail:h,email:g,jobId:f,message:i}});return true});var d=b.find("#message");if(d.val()==""){d.val(d.attr("title"));d.one("focus",function(){d.val("")})}var c=b.find("#fromEmail");if(c.val()==""){c.val(c.attr("title"));c.one("focus",function(){c.val("")})}var a=b.find("#email");if(a.val()==""){a.val(a.attr("title"));a.one("focus",function(){a.val("")})}};worky.forms.CandidateSendLinkForm=function(a){worky.forms.Form.call(this,a)};worky.forms.CandidateSendLinkForm.prototype=new worky.forms.Form();worky.forms.CandidateSendLinkForm.prototype.constructor=worky.forms.CandidateSendLinkForm;worky.forms.CandidateSendLinkForm.prototype.init=function(){worky.forms.Form.prototype.init.call(this);var b=this.element;b.bind("submit",function(h){h.preventDefault();h.stopPropagation();var g=b.find("#candidateId")[0].value;var d=b.find("#email")[0].value;var f=b.find("#message")[0].value;var i=function(n){var o=b.find(".errors");if(o.length>0){o.remove()}var m=$(worky.createElement("div")).addClass("flashes-ajax").prependTo(b);if(n.flashes){var j=0;for(j=0;j<n.flashes.length;j++){var e=n.flashes[j];worky.flashAddMessage(m,e)}}if(n.data.errors){var l=$(worky.createElement("ul")).addClass("errors");$.each(n.data.errors,function(p,q){if(q.length>0){l.append($(worky.createElement("li")).text(p+": "+q))}});b.append(l)}};jQuery.ajax({type:"POST",url:b.attr("action"),dataType:"json",success:i,data:{email:d,candidateId:g,message:f}});return true});var c=b.find("#message");if(c.val()==""){c.val(c.attr("title"));c.one("focus",function(){c.val("")})}var a=b.find("#email");if(a.val()==""){a.val(a.attr("title"));a.one("focus",function(){a.val("")})}};worky.forms.HirerCustomRejectionMessageForm=function(a){worky.forms.Form.call(this,a)};worky.forms.HirerCustomRejectionMessageForm.prototype=new worky.forms.Form();worky.forms.HirerCustomRejectionMessageForm.prototype.constructor=worky.forms.HirerCustomRejectionMessageForm;worky.forms.HirerCustomRejectionMessageForm.prototype.init=function(){worky.forms.Form.prototype.init.call(this);var a=this.element;this.url=a.attr("action");var b=this;a.bind("submit",function(g){g.preventDefault();g.stopPropagation();var f=a.find("#candidate-id")[0].value;var c=a.find("#job-id")[0].value;var d=a.find("#rejection-message")[0].value;var h=function(m){var j=$("body").find(".form-message-box");var l=$(worky.createElement("div")).addClass("flashes-ajax").prependTo(j);if(m.flashes){l.empty();var e=0;for(e=0;e<m.flashes.length;e++){var n=m.flashes[e];worky.flashAddMessage(l,n)}}if(m.data.ok){$.facebox.close()}};jQuery.ajax({type:"POST",url:b.url,dataType:"json",success:h,data:{jobId:c,candidateId:f,rejectionMessage:d}});return true})};worky.forms.CandidateQualificationForm=function(a){worky.forms.Form.call(this,a)};worky.forms.CandidateQualificationForm.loadForm=function(a){return worky.forms.Form.loadForm(a)};worky.forms.CandidateQualificationForm.prototype=new worky.forms.Form();worky.forms.CandidateQualificationForm.prototype.constructor=worky.forms.CandidateQualificationForm;worky.forms.CandidateQualificationForm.prototype.init=function(){worky.forms.Form.prototype.init.call(this);var a=this;a.select=a.element.find("select#type");a.select.bind("change",function(){a.updateSentenceElementsVisibility()});a.updateSentenceElementsVisibility();new worky.widgets.Autocompleter(this.element.find("#qualificationSubject"),worky.base_url+"data/qualification-subject-autocomplete");a.element.find(".dialog-ok").bind("click",function(){a.send()});var b={qualificationSubject:worky.translate("choose the subject..."),qualificationInstitution:worky.translate("choose the institution..."),qualificationYear:worky.translate("type year... (optional)")};var c;for(var d in b){c=a.element.find("input[name="+d+"]");if(c.length==1&&c.val()==""){c.val(b[d]);c.one("focus",function(){$(this).val("");return true})}}};worky.forms.CandidateQualificationForm.prototype.send=function(){var d=this;var e={};var b=this.element.serializeArray();for(var a in b){var c=b[a];e[c.name]=c.value}var f=d.element.find(".dialog-ok");worky.shadeElement(f);$.ajax({type:"post",dataType:"json",url:worky.base_url+"qualification/save-qualification",data:e,success:function(g){worky.unshadeElement(f);if(g.data.ok){$(".qualifications-container").replaceWith(g.data.qualifications);$.facebox.close()}else{worky.widgets.setErrors(null,d.element.find(".error-list"),g.data.errors)}},error:function(){worky.unshadeElement(f)}})};worky.forms.CandidateQualificationForm.prototype.updateSentenceElementsVisibility=function(){var e=this;var d=e.element.find(".qualification-subject-prefix");var b=e.element.find(".qualification-subject-part");var c=e.element.find(".qualification-institution-prefix");var g=e.element.find(".qualification-institution-part");var a=e.element.find(".qualification-year-prefix");var h=e.element.find(".qualification-year-part");b.hide();g.hide();h.hide();d.hide();c.hide();a.hide();var f=e.select.val();if(f&&f.indexOf("i")>-1){g.show();h.show();if(f&&f.indexOf("m")>-1){c.text("of");a.text("since")}else{if(f&&f.indexOf("c")>-1){c.text("at");a.text("since")}else{c.text("from");a.text("in")}}c.show();a.show()}if(f&&f.indexOf("s")>-1){b.show();if(f&&f.indexOf("c")<0){d.show()}}};worky.jobs={};worky.jobs.reject=function(a,c){var b=function(d){if(d.data.ok){worky.notifications.trigger("job-rejected",a)}};jQuery.ajax({url:worky.base_url+"job/reject",type:"POST",dataType:"json",data:{id:a,rejectionMessage:"0"},success:b})};worky.jobs.unreject=function(a){var b=function(c){if(c.data.ok){worky.notifications.trigger("job-unrejected",a)}};jQuery.ajax({url:worky.base_url+"job/unreject",type:"POST",dataType:"json",data:{id:a},success:b})};worky.jobs.favourite=function(b){var a=function(c){if(c.data.ok){worky.notifications.trigger("job-favourited",b)}worky.favouritingInProgress=0};jQuery.ajax({url:worky.base_url+"job/add-favourite",type:"POST",dataType:"json",data:{id:b},success:a})};worky.jobs.unfavourite=function(b){var a=function(c){if(c.data.ok){worky.notifications.trigger("job-unfavourited",b)}worky.favouritingInProgress=0};jQuery.ajax({url:worky.base_url+"job/remove-favourite",type:"POST",dataType:"json",data:{id:b},success:a})};worky.jobs.changeStatus=function(){$("form#hirer-filter-job-status").submit()};worky.jobs.serializeAndSendFilterForm=function(){var a=$("form#hirer-job-selects");var b=a.serialize();worky.loadToElement($("#jobListContainer"),worky.base_url+"job/index?"+b,function(){})};worky.companies={};worky.companies.favourite=function(b){var a=function(c){if(c.data.ok){worky.notifications.trigger("company-favourited",b)}else{alert("unable to favourite this company")}};jQuery.ajax({url:worky.base_url+"company/favourite",type:"POST",dataType:"json",data:{id:b},success:a})};worky.companies.unfavourite=function(a){var b=function(c){if(c.data.ok){worky.notifications.trigger("company-unfavourited",a)}else{alert("unable to unfavourite this company")}};jQuery.ajax({url:worky.base_url+"company/unfavourite",type:"POST",dataType:"json",data:{id:a},success:b})};worky.candidate={};worky.candidate.reloadCounts=function(){var a=$(".candidate-filter-buttons");if(a.length==0){return}var d=$("input#recountParams");if(d.length==0){return}var c=d.val();if(!c||c==""){return}jQuery.ajax({url:worky.base_url+"candidate/search-count?"+c,type:"POST",dataType:"json",success:function(f){var e=f.data;a.find(".job-filter-count").each(function(){var g=$(this);var h=g.attr("id").substr("candidate-filter-count-".length);if(e[h]&&e[h]>0){g.text("("+e[h]+")");g.css("display","inline")}else{g.text("");g.hide()}})}});var b=$("span#remaining-job-approach-credits-count");if(b.length>0){jQuery.ajax({url:worky.base_url+"job/remaining-job-approach-credits-count/?"+c,type:"GET",dataType:"json",success:function(f){var e=f.data["remaining-job-approach-credits"];b.text(e)}})}};worky.candidate.getCurrentFilter=function(){var a=jQuery.trim($("#current-filter").text());return a?a.toLowerCase():"default"};var events=["candidate-approached","candidate-applied","candidate-favourited","candidate-unfavourited","candidate-rejected","candidate-unrejected"];$.each(events,function(b,a){worky.notifications.registerEvent(a,worky.candidate.reloadCounts)});var events=["candidate-unfavourited","candidate-rejected","candidate-unrejected"];$.each(events,function(b,a){worky.notifications.registerEvent(a,worky.candidate.reloadPaginationInfo)});worky.candidate.reject=function(b){var a=function(f){if(f.data.ok&&f.data.values&&f.data.values.candidateId){var e=f.data.values.candidateId;var c=f.data.values.jobId;if(!e){e=""}if(!c){c=""}worky.notifications.trigger("candidate-rejected",{candidateId:e,jobId:c});if(f.data.values.rejectMessage=="1"){var d=worky.translate("Should worky send standard rejection message to this candidate?");if(confirm(d)){var g="jobId="+c+"&candidateId="+e;worky.loadToDialog(worky.base_url+"hirer/prepare-candidate-rejection-message?"+g,"")}}}};jQuery.ajax({url:b,type:"POST",dataType:"json",success:a})};worky.candidate.unreject=function(a){var b=function(c){if(c.data.ok&&c.data.values){worky.notifications.trigger("candidate-unrejected",c.data.values)}};jQuery.ajax({url:a,type:"POST",dataType:"json",success:b})};worky.candidate.favourite=function(b){var a=function(e){if(e.data.ok&&e.data.values){var d=e.data.values.candidateId;var c=e.data.values.jobId;worky.notifications.trigger("candidate-favourited",{candidateId:d,jobId:c})}};jQuery.ajax({url:b,type:"POST",dataType:"json",success:a})};worky.candidate.unfavourite=function(a){var b=function(c){if(c.data.ok&&c.data.values){worky.notifications.trigger("candidate-unfavourited",c.data.values)}};jQuery.ajax({url:a,type:"POST",dataType:"json",success:b})};worky.candidate.follow=function(a){var b=function(c){if(c.data.ok&&c.data.values){}};jQuery.ajax({url:a,type:"POST",dataType:"json",success:b})};worky.candidate.unfollow=function(b){var a=function(c){if(c.data.ok&&c.data.values){}};jQuery.ajax({url:url,type:"POST",dataType:"json",success:a})};worky.candidate.reloadFlag=function(a,c){if(!a){return false}var b=$(".candidate-nationality-flag");if(b.length>0){var d=worky.base_url+"images/flags/"+a.toLowerCase()+".gif";b.find("img").attr("src",d).attr("title",c).attr("alt",c)}return false};worky.candidate.reloadFullName=function(a){$("#signup-links a.full-name-label-link").text(a);$("#candidate-profile-login").text(a)};worky.candidate.reloadEducationDegree=function(a){$(".candidate-highest-degree").text(a)};worky.candidate.reloadDisplayName=function(a){$(".profile-card-header .profile-card-full-name").text(a)};worky.candidate.reloadSkills=function(a){$("#candidate-skill-list").html(a)};worky.candidate.reloadAge=function(a){var b=((a)?"("+a+")":"");$(".candidateCard-stats .candidate-card-age").text(b)};worky.candidate.reloadGender=function(a){switch(a){case"male":case"female":$(".candidate-gender").html('<img title="'+a+'" alt="'+a+'" src="'+worky.base_url+"images/candidate-card/"+a+'.gif"/>');break;default:$(".candidate-gender").text("")}};jQuery.fn.extend({worky_shade:function(a){worky.shadeElement(this,a);return this},worky_unshade:function(){worky.unshadeElement(this);return this},worky_hint:function(a){worky.widgets.hint(this,a);return this},worky_autocomplete:function(a){new worky.widgets.Autocompleter(this,a);return this}});jQuery.fn.toXML=function(){var a=function(h){var e="";var d="";var g="";e+="<"+h.nodeName;if(h.childNodes){for(var f=0;f<h.childNodes.length;f++){switch(h.childNodes[f].nodeType){case 1:g+=a(h.childNodes[f]);break;case 2:d+=" "+h.childNodes[f].nodeName+'="'+h.childNodes[f].nodeValue+'"';break;case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:g+=h.childNodes[f].nodeValue;break}}}e+=d;if(g.length>0){e+=">"+g;e+="</"+h.tagName+">"}else{e+="/>"}return e};var c="";if(this.length>0){if(typeof XMLSerializer=="function"||typeof XMLSerializer=="object"){var b=new XMLSerializer();this.each(function(){c+=b.serializeToString(this)})}else{if(this[0].xml!==undefined){this.each(function(){c+=this.xml})}else{if(this.length>0){this.each(function(){c+=a(this)})}}}}return c};worky.map={};worky.map.widget=null;worky.map.markers=null;worky.map._clusterer=null;worky.map.topResults=25;worky.map.intervalId=0;worky.map.circle=null;worky.map.control=null;worky.map.isActive=function(){return !!(worky.map.widget&&worky.map._clusterer)};worky.map._libraries_loaded=false;worky.map.init=function(e){var b=$("#map");if(b.size()>0&&GBrowserIsCompatible()){worky.map.widget=new GMap2(b[0]);worky.map.widget.setCenter(new GLatLng(53.35,-6.26),12);worky.map.widget.enableScrollWheelZoom();worky.map.widget.enableDoubleClickZoom();worky.map._clusterer=new Clusterer(worky.map.widget);worky.map._clusterer.SetMaxVisibleMarkers(70);var c=worky.map.getOptionsForIcon();var d=new GIcon();for(var a in c.icon){d[a]=c.icon[a]}worky.map._clusterer.SetIcon(d);worky.map.markers=new Array();worky.map.control=new GLargeMapControl();worky.map.widget.addControl(worky.map.control);if(e){e()}if(b.parents(".dialog").length>0){$(document).one("close.facebox",worky.map.destroy)}}};worky.map.destroy=function(){if(!worky.map.isActive){return}for(var a in worky.map.markers){worky.map._clusterer.RemoveMarker(a)}worky.map.markers=null;worky.map._clusterer=null;worky.map.widget=null};worky.map.centerOnTopMarkers=function(){$(document).ready(function(){if(!worky.map.isActive()){return}var d=worky.map.markers;var a=worky.map.topResults;if(a>=d.length){a=d.length}if(a==0){return}var c=new GLatLngBounds();for(var b=0;b<a;++b){c.extend(d[b].getLatLng())}worky.map.widget.setCenter(c.getCenter());worky.map.widget.setZoom(worky.map.widget.getBoundsZoomLevel(c))})};worky.map.infoWindowOpen=function(){this.bubbleDisplayed=true};worky.map.infoWindowClose=function(){this.bubbleDisplayed=false};worky.map.addMarker=function(g,d,c,b){if(!worky.map.isActive()){return null}if(typeof(b)=="undefined"){b={}}if(b.icon){var f=new GIcon(G_DEFAULT_ICON);for(var e in b.icon){f[e]=b.icon[e]}b.icon=f}var a=new GMarker(new GLatLng(g,d),b);GEvent.addListener(a,"infowindowopen",worky.map.infoWindowOpen);GEvent.addListener(a,"infowindowclose",worky.map.infoWindowClose);worky.map._clusterer.AddMarker(a,c);worky.map.markers.push(a);return a};worky.map.removeMarker=function(b){var d=worky.map.markers;var a=null;for(var c=0;c<d.length;c++){if(d[c]==b){a=c}}if(a!=null){worky.map._clusterer.RemoveMarker(b);worky.map.markers.splice(a,1);return true}else{return false}};worky.map.bindClickOnMarker=function(a,b){GEvent.addListener(a,"click",b)};worky.map.setMarkerKey=function(a,b){a.workyKey=b};worky.map.getMarkerKey=function(a){return a.workyKey};worky.map.getPinWithKey=function(b){if(!worky.map.isActive()){return null}var c=worky.map.markers;for(var a=0;a<c.length;++a){if(worky.map.getMarkerKey(c[a])==b){return c[a]}}return null};worky.map.maximizeWindowIfLoaded=function(){var a=worky.map.widget.getInfoWindow();var b=a.getContentContainers()[0];if(!a.isHidden()&&b){if(worky.map.intervalId){clearInterval(worky.map.intervalId);worky.map.intervalId=null}worky.map.widget.getInfoWindow().maximize()}};worky.map.setMaximizeHandler=function(a){if(worky.map.maximizeHandle){GEvent.removeListener(worky.map.maximizeHandle)}worky.map.maximizeHandle=GEvent.addListener(worky.map.widget.getInfoWindow(),"maximizeclick",a)};worky.map.drawCircle=function(centerMarker,circleRadius,options){if(typeof(options)=="undefined"){options={}}var transparency=($.browser.msie&&parseFloat($.browser.version)<7)?false:true;var map=worky.map.widget;var center=centerMarker.getLatLng();if(typeof(options.metricUnit)=="undefined"){options.metricUnit="KM"}if(worky.map.circle){map.removeOverlay(worky.map.circle)}var bounds=new GLatLngBounds();var circlePoints=Array();with(Math){var d=0;if(options.metricUnit=="KM"){d=circleRadius/6378.8}else{if(options.metricUnit=="MILE"){d=circleRadius/3963.189}}var lat1=(PI/180)*center.lat();var lng1=(PI/180)*center.lng();for(var a=0;a<361;a++){var tc=(PI/180)*a;var y=asin(sin(lat1)*cos(d)+cos(lat1)*sin(d)*cos(tc));var dlng=atan2(sin(tc)*sin(d)*cos(lat1),cos(d)-sin(lat1)*sin(y));var x=((lng1-dlng+PI)%(2*PI))-PI;var point=new GLatLng(parseFloat(y*(180/PI)),parseFloat(x*(180/PI)));circlePoints.push(point);bounds.extend(point)}if(transparency){circle=new GPolygon(circlePoints,"#0000AA",1,1,"#00FF00",0.15)}else{circle=new GPolygon(circlePoints,"#0000AA",2,1)}map.addOverlay(circle);worky.map.circle=circle;suggestedZoomLevel=map.getBoundsZoomLevel(bounds);if(options.zoom==true){map.setZoom(suggestedZoomLevel)}if(options.zoomForSmaller==true){if(suggestedZoomLevel<map.getZoom()){map.setZoom(suggestedZoomLevel)}}if(options.centerOn==true){map.panTo(center)}}};worky.map.getOptionsForIcon=function(a){if(!worky.map.isActive()){return{}}if(typeof(a)==undefined){a="default"}var b={};b.icon={};switch(a){case"default":b.icon.image=worky.base_url+"images/map/mapIcon-orange.png";b.icon.printImage=worky.base_url+"images/map/mapIcon-orange.git";break;case"agency":b.icon.image=worky.base_url+"images/map/mapIcon-red.png";b.icon.printImage=worky.base_url+"images/map/mapIcon-red.gif";break;case"location":b.icon.image=worky.base_url+"images/map/mapIcon-blue.png";b.icon.printImage=worky.base_url+"images/map/mapIcon-blue.gif";b.draggable=true;break;case"desiredLocation":b.icon.image=worky.base_url+"images/map/mapIcon-green.png";b.icon.printImage=worky.base_url+"images/map/mapIcon-green.gif";b.draggable=true;break;default:b.icon.image=worky.base_url+"images/map/mapIcon-orange.png";b.icon.printImage=worky.base_url+"images/map/mapIcon-orange.gif"}b.icon.shadow=worky.base_url+"images/map/mapIcon-shadow.png";b.icon.printShadow=worky.base_url+"images/map/mapIcon-shadow.gif";b.icon.iconSize=new GSize(24,27);b.icon.shadowSize=new GSize(38,27);b.icon.iconAnchor=new GPoint(12,13);b.icon.infoWindowAnchor=new GPoint(12,13);return b};worky.location={};worky.location.default_latitude=53.3411959;worky.location.default_longitude=-6.2762753;worky.location.__geocoder=null;worky.location.locationPins=null;worky.location.__geocode=function(a,b){if(!worky.location.__geocoder){worky.location.__geocoder=new GClientGeocoder()}worky.location.__geocoder.getLatLng(a,b)};worky.location.__handleSaveClicked=function(e){if(e){e.preventDefault()}var d;var b;var c;var g;var f;var a=worky.map.markers.length;for(d=0;d<a;d++){b=worky.map.markers[d];c=worky.map.getMarkerKey(b);if(c&&c.callback){f=b.getLatLng();g={};g.latitude=parseFloat(f.lat());g.longitude=parseFloat(f.lng());c.callback(g)}}worky.location.destroy();return false};worky.location.__addPinWithCoordinates=function(d,a){var c=worky.map.getOptionsForIcon(d.pinType);var b=worky.map.addMarker(d.lat,d.lng,d.prefix,c);worky.map.setMarkerKey(b,d);d.marker=b;if(a){worky.location.centerMapOnPin(d)}return true};worky.location.addPin=function(c,a,d){var b=0.005;if(c.hasCoordinates()){if(d){c.lat=parseFloat(c.lat)+b;c.lng=parseFloat(c.lng)+b}worky.location.__addPinWithCoordinates(c,a)}else{worky.location.__geocode(c.addressToGeocode(),function(e){if(e){c.lat=e.lat();c.lng=e.lng()}else{c.lat=worky.location.default_latitude;c.lng=worky.location.default_longitude}if(d){c.lat=c.lat+b;c.lng=c.lng+b}worky.location.__addPinWithCoordinates(c,a)})}};worky.location.centerMapOnPin=function(b){var a=worky.map.getPinWithKey(b);if(a){worky.map.widget.setCenter(a.getLatLng());return true}else{return false}};worky.location.LocationPin=function(a,b,c){this.marker=null;this.pinType=a;if(b){this.prefix=b;this.address=$("#"+b+"_address").val();this.city=$("#"+b+"_city_name").val();this.region=$("#"+b+"_region_name").val();this.lat=$("#"+b+"_latitude").val();this.lng=$("#"+b+"_longitude").val();this.country=$("#"+b+"_country_name").val();this.radius=$("#"+b+"_radius").val()}if(typeof(c)=="undefined"){this.callback=function(d){$("#"+b+"_latitude").val(d.latitude);$("#"+b+"_longitude").val(d.longitude)}}else{this.callback=c}};worky.location.LocationPin.prototype.hasCoordinates=function(){if(!isNaN(parseFloat(this.lat))&&!isNaN(parseFloat(this.lng))){if(parseFloat(this.lat)!=0&&parseFloat(this.lng)!=0){return true}}return false};worky.location.LocationPin.prototype.addressToGeocode=function(){if(!this.country){return""}var a="";if(this.address!=""){a=this.address+", "}if(this.city!=""){a+=this.city+", "}if(this.region!=""){a+=this.region+", "}a+=this.country;return a};worky.location.LocationPin.prototype.drawRadius=function(a){if(!this.radius||!this.marker){return false}if(typeof(a)=="undefined"){a={}}worky.map.drawCircle(this.marker,this.radius,a);return false};worky.location.init=function(b,c){if(b==null||b.length==0){return}worky.location.locationPins=b;var a=this;worky.map.init(function(){var f=null;var e=null;var h=null;var g=false;for(f=0;f<b.length;f++){e=b[f];g=false;if(e.pinType=="desiredLocation"){h=e;g=true;if(!e.lat.length||!e.lng.length){e.lat=worky.location.default_latitude;e.lng=worky.location.default_longitude}}worky.location.addPin(e,true,g)}worky.map.centerOnTopMarkers();if(h){var d=h;d.drawRadius({zoomForSmaller:true});GEvent.addListener(d.marker,"dragend",function(){worky.map.drawCircle(d.marker,d.radius,{centerOn:true})})}$("a#save-location").bind("click",worky.location.__handleSaveClicked);if(c){c(a)}})};worky.location.destroy=function(){$.facebox.close();worky.map.destroy()};worky.forms.MessageBoxForm=function(a){worky.forms.Form.call(this,a)};worky.forms.MessageBoxForm.prototype=new worky.forms.Form();worky.forms.MessageBoxForm.prototype.constructor=worky.forms.MessageBoxForm;worky.forms.MessageBoxForm.prototype.init=function(){worky.forms.Form.prototype.init.call(this);var b=this;var g=this.element;var j=g.hasClass("close-after-sending");var c=this.element.find(".toggable-div-deactivator");c.bind("click",worky.widgets.toggableDivHide);var h=this.element.find(".toggable-div-activator");h.bind("click",worky.widgets.toggableDivShow);var i=$("body").find(".form-message-box");var d=g.find(".compose-message");var e=$(worky.createElement("div")).addClass("flashes-ajax").prependTo(i);b.updateMessageVisibility();if(d.size()>0){var f=d.attr("action");if(f.indexOf("?")<0){f+="?"}else{f+="&"}f+="format=jsontext";d.attr("action",f);var a=d.find("textarea");if(a.val()==""){a.val(a.attr("title"));a.one("focus",function(){a.val("")})}var l=function(){b.updateMessageVisibility()};g.find("#jobId").bind("change",l).bind("keyup",l);worky.asyncForm(d,function(n){var o=worky.decodeJSONTextResponse(n);if(!o){return false}setTimeout(function(){n.remove()},500);worky.widgets.setManyErrors(d,o.data.errors);e.empty();if(o.flashes){var m=0;for(m=0;m<o.flashes.length;m++){var q=o.flashes[m];worky.flashAddMessage(e,q)}}if(o.data.ok){if(o.data.values.message_type=="application"){worky.notifications.trigger("job-applied",o.data.values.jobId);worky.applications.updateLinkAfterApplied(g,o.data.values.jobId)}else{if(o.data.values.message_type=="approach"){worky.notifications.trigger("candidate-approached",o.data.values.recipientId);worky.approaches.updateLinkAfterApproached(g,o.data.values.recipientId)}}if(j||($.browser.msie&&parseInt($.browser.version)<=6)){$.facebox.close()}else{$(".messages").prepend(o.data.rendered_message);$(".message-list-placeholder-text").remove();d.get(0).reset();d.find("#jobId").val(o.data.values.jobId)}worky.widgets.toggableDivHide.call(h);var p=$("span.button-message");if(p.hasClass("remove-button-msg-after")){p.text("")}}return true})}};worky.forms.MessageBoxForm.prototype.updateMessageVisibility=function(){var a=this.element;var b=a.find("#jobId").val();if(b){$(".messages .message").hide();$(".messages .message-for-job-"+b.toString()).show()}else{$(".messages .message").show()}};worky.desiredRadiusSlider={};worky.desiredRadiusSlider.labelDiv=null;worky.desiredRadiusSlider.slider=null;worky.desiredRadiusSlider.init=function(a){worky.desiredRadiusSlider.labelDiv=$(".radius-slider-label");var b=worky.desiredRadiusSlider._prepareSliderValues();var c=new worky.widgets.EnumerationSlider($("#radius-slider"),b,{},{initialPositionCallback:function(e){for(var d in b){if(b[d][1]==e){return d}}return 0},addLabel:false,slide:function(f,d){worky.desiredRadiusSlider.updateLabel(d.value)},change:function(f,d){worky.desiredRadiusSlider.radiusSlide(d.value,a)}});worky.desiredRadiusSlider.slider=c;worky.desiredRadiusSlider.updateLabel(c.position())};worky.desiredRadiusSlider._prepareSliderValues=function(){var b=new Array();var a=new Array();var d=1;for(d;d<10;d++){b.push(d)}for(d;d<50;d+=5){b.push([d])}for(d;d<=200;d+=10){b.push([d])}for(var c=0;c<b.length;c++){a.push([c,b[c]])}return a};worky.desiredRadiusSlider.getDesiredLocationPinAndInit=function(a){var c=null;for(var b=0;b<a.locationPins.length;b++){locationPin=a.locationPins[b];if(typeof(locationPin.radius)!="undefined"&&locationPin.prefix=="desiredLocation"){c=locationPin}}worky.desiredRadiusSlider.init(c)};worky.desiredRadiusSlider.radiusSlide=function(a,b){b.radius=worky.desiredRadiusSlider.slider._positionToLabel(a);this.radius=b.radius;worky.desiredRadiusSlider.updateLabel(a);b.drawRadius({zoom:true,centerOn:true})};worky.desiredRadiusSlider.updateLabel=function(a){var b=worky.desiredRadiusSlider.slider._positionToLabel(a);worky.desiredRadiusSlider.labelDiv.text(b+"km")};